"""
Layher Scaffolding Standards Library
====================================
–°–¢–ê–¢–£–°: Non-negotiable (–û–±—Å—É–∂–¥–µ–Ω–∏—é –Ω–µ –ø–æ–¥–ª–µ–∂–∏—Ç)

–í—Å–µ —Ä–∞–∑–º–µ—Ä—ã –≤ –º–µ—Ç—Ä–∞—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –†–ï–ê–õ–¨–ù–´–ú —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Layher Allround.
–ù–∏–∫–∞–∫–∏—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö float-–∑–Ω–∞—á–µ–Ω–∏–π. –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ –≤ —ç—Ç–æ–º —Å–ø–∏—Å–∫–µ ‚Äî —ç—Ç–æ –ë–†–ê–ö.
"""
from typing import List, Dict, Tuple, Optional
from dataclasses import dataclass
from enum import Enum
import math


class ComponentType(Enum):
    """–¢–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–µ—Å–æ–≤ Layher"""
    STANDARD = "standard"      # –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç–æ–π–∫–∞
    LEDGER = "ledger"          # –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä–∏–≥–µ–ª—å
    TRANSOM = "transom"        # –ü–æ–ø–µ—Ä–µ—á–Ω–∞—è –±–∞–ª–∫–∞
    DIAGONAL = "diagonal"      # –î–∏–∞–≥–æ–Ω–∞–ª—å (—Ä–∞—Å–ø–æ—Ä–∫–∞)
    DECK = "deck"              # –ù–∞—Å—Ç–∏–ª
    BASE_PLATE = "base_plate"  # –û–ø–æ—Ä–Ω–∞—è –ø–ª–∞—Å—Ç–∏–Ω–∞
    ROSETTE = "rosette"        # –†–æ–∑–µ—Ç–∫–∞ (—É–∑–µ–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)


@dataclass
class LayherComponent:
    """–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–µ—Å–æ–≤ Layher"""
    type: ComponentType
    length: float  # –º–µ—Ç—Ä—ã
    weight: float  # –∫–≥
    max_load: float  # –∫–ù (–∫–∏–ª–æ–Ω—å—é—Ç–æ–Ω—ã)
    code: str  # –∞—Ä—Ç–∏–∫—É–ª Layher
    
    def __repr__(self):
        return f"{self.type.value}_{self.length}m ({self.code})"


class LayherStandards:
    """
    –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã Layher Allround - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
    ============================================================
    –ò—Å—Ç–æ—á–Ω–∏–∫: Layher Allround Scaffolding Technical Manual
    
    –ü–†–ê–í–ò–õ–û: –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ –≤ —Å–ø–∏—Å–∫–µ ‚Äî –ò–ò –¥–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏ –ë–õ–ò–ñ–ê–ô–®–ò–ô —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π.
    """
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –î–õ–ò–ù–´ –†–ò–ì–ï–õ–ï–ô (Ledgers) –≤ –º–µ—Ç—Ä–∞—Ö
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    LEDGER_LENGTHS = [
        0.73,   # 730 –º–º
        1.09,   # 1090 –º–º
        1.40,   # 1400 –º–º
        1.57,   # 1570 –º–º
        2.07,   # 2070 –º–º (–ù–ï 2.0–º –∏ –ù–ï 2.13–º!)
        2.57,   # 2570 –º–º
        3.07,   # 3070 –º–º (–ù–ï 3.0–º!)
    ]
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –í–´–°–û–¢–´ –°–¢–û–ï–ö (Standards) –≤ –º–µ—Ç—Ä–∞—Ö
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    STANDARD_HEIGHTS = [
        0.50,   # 500 –º–º
        1.00,   # 1000 –º–º
        1.50,   # 1500 –º–º
        2.00,   # 2000 –º–º (–ù–ï 2.5–º!)
        2.50,   # 2500 –º–º
        3.00,   # 3000 –º–º
    ]
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –î–õ–ò–ù–´ –î–ò–ê–ì–û–ù–ê–õ–ï–ô (Diagonals)
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    DIAGONAL_LENGTHS = [
        2.00,   # –¥–ª—è –≤—ã—Å–æ—Ç—ã 2.0–º
        2.50,   # –¥–ª—è –≤—ã—Å–æ—Ç—ã 2.5–º
        3.00,   # –¥–ª—è –≤—ã—Å–æ—Ç—ã 3.0–º
        3.50,   # –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–µ–∫—Ü–∏–π
    ]
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –°–¢–ê–ù–î–ê–†–¢–ù–´–ï –†–ê–ó–ú–ï–†–´ –ù–ê–°–¢–ò–õ–û–í (—à–∏—Ä–∏–Ω–∞ x –¥–ª–∏–Ω–∞)
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    DECK_SIZES = [
        (0.61, 0.73),   # –£–∑–∫–∏–π –Ω–∞—Å—Ç–∏–ª
        (0.61, 1.09),
        (0.61, 1.57),
        (0.61, 2.07),
        (0.61, 2.57),
        (0.61, 3.07),
    ]
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö–ò –†–û–ó–ï–¢–û–ö (Rosettes)
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    ROSETTE_MAX_CONNECTIONS = 8  # –ú–∞–∫—Å–∏–º—É–º 8 —Ä–∏–≥–µ–ª–µ–π –≤ –æ–¥–Ω—É —Ä–æ–∑–µ—Ç–∫—É
    ROSETTE_VERTICAL_SPACING = 0.50  # –†–æ–∑–µ—Ç–∫–∏ —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–µ 50—Å–º –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –î–û–ü–£–°–¢–ò–ú–´–ï –ù–ê–ì–†–£–ó–ö–ò (–≤ –∫–ù - –∫–∏–ª–æ–Ω—å—é—Ç–æ–Ω–∞—Ö)
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    MAX_LEDGER_LOAD = {
        0.73: 3.0,
        1.09: 3.0,
        1.40: 3.0,
        1.57: 3.0,
        2.07: 3.0,
        2.57: 2.5,  # –î–ª–∏–Ω–Ω—ã–µ —Ä–∏–≥–µ–ª–∏ ‚Äî –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞
        3.07: 2.0,
    }
    
    MAX_STANDARD_LOAD = 50.0  # –∫–ù –Ω–∞ –æ–¥–Ω—É —Å—Ç–æ–π–∫—É
    MAX_DIAGONAL_TENSION = 15.0  # –∫–ù –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    SAFETY_FACTOR = 1.5
    CRITICAL_LOAD_THRESHOLD = 0.90  # 90% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞ ‚Äî –ö–†–ê–°–ù–ê–Ø –ó–û–ù–ê
    WARNING_LOAD_THRESHOLD = 0.70   # 70% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞ ‚Äî –ñ–ï–õ–¢–ê–Ø –ó–û–ù–ê
    
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –§–ò–ó–ò–ß–ï–°–ö–ò–ï –°–í–û–ô–°–¢–í–ê –ö–û–ú–ü–û–ù–ï–ù–¢–û–í
    # ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    # –¢—Ä—É–±–∞ 48.3mm OD x 3.2mm WT (—Å—Ç–∞–Ω–¥–∞—Ä—Ç Layher)
    PIPE_OUTER_DIAMETER = 0.0483  # –º
    PIPE_WALL_THICKNESS = 0.0032  # –º
    PIPE_CROSS_SECTION_AREA = 4.5e-4  # –º¬≤
    PIPE_MOMENT_OF_INERTIA = 1.1e-7  # –º‚Å¥
    PIPE_TORSION_CONSTANT = 2.2e-7  # –º‚Å¥
    
    # –°—Ç–∞–ª—å S235JR (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–µ—Å–æ–≤)
    STEEL_YOUNGS_MODULUS = 2.1e11  # –ü–∞ (–º–æ–¥—É–ª—å –Æ–Ω–≥–∞)
    STEEL_YIELD_STRENGTH = 235e6   # –ü–∞ (–ø—Ä–µ–¥–µ–ª —Ç–µ–∫—É—á–µ—Å—Ç–∏)
    STEEL_DENSITY = 7850           # –∫–≥/–º¬≥
    
    @classmethod
    def get_nearest_ledger_length(cls, target_length: float) -> float:
        """
        –ù–∞—Ö–æ–¥–∏—Ç –±–ª–∏–∂–∞–π—à—É—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –¥–ª–∏–Ω—É —Ä–∏–≥–µ–ª—è.
        
        –ü—Ä–∏–º–µ—Ä—ã:
        - –ó–∞–ø—Ä–æ—Å–∏–ª–∏ 1.23–º ‚Üí –≤–µ—Ä–Ω–µ—Ç 1.09–º
        - –ó–∞–ø—Ä–æ—Å–∏–ª–∏ 2.0–º  ‚Üí –≤–µ—Ä–Ω–µ—Ç 2.07–º (–ù–ï 2.0–º!)
        - –ó–∞–ø—Ä–æ—Å–∏–ª–∏ 2.13–º ‚Üí –≤–µ—Ä–Ω–µ—Ç 2.07–º
        
        Args:
            target_length: –ñ–µ–ª–∞–µ–º–∞—è –¥–ª–∏–Ω–∞ –≤ –º–µ—Ç—Ä–∞—Ö
            
        Returns:
            –ë–ª–∏–∂–∞–π—à–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥–ª–∏–Ω–∞ –∏–∑ LEDGER_LENGTHS
        """
        if target_length <= 0:
            return cls.LEDGER_LENGTHS[0]
        
        # –ù–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à—É—é –¥–æ–ø—É—Å—Ç–∏–º—É—é –¥–ª–∏–Ω—É
        nearest = min(cls.LEDGER_LENGTHS, key=lambda x: abs(x - target_length))
        return nearest
    
    @classmethod
    def get_nearest_standard_height(cls, target_height: float) -> float:
        """
        –ù–∞—Ö–æ–¥–∏—Ç –±–ª–∏–∂–∞–π—à—É—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –≤—ã—Å–æ—Ç—É —Å—Ç–æ–π–∫–∏.
        
        –ü—Ä–∏–º–µ—Ä—ã:
        - –ó–∞–ø—Ä–æ—Å–∏–ª–∏ 2.3–º ‚Üí –≤–µ—Ä–Ω–µ—Ç 2.5–º
        - –ó–∞–ø—Ä–æ—Å–∏–ª–∏ 1.8–º ‚Üí –≤–µ—Ä–Ω–µ—Ç 2.0–º
        
        Args:
            target_height: –ñ–µ–ª–∞–µ–º–∞—è –≤—ã—Å–æ—Ç–∞ –≤ –º–µ—Ç—Ä–∞—Ö
            
        Returns:
            –ë–ª–∏–∂–∞–π—à–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∏–∑ STANDARD_HEIGHTS
        """
        if target_height <= 0:
            return cls.STANDARD_HEIGHTS[0]
        
        nearest = min(cls.STANDARD_HEIGHTS, key=lambda x: abs(x - target_height))
        return nearest
    
    @classmethod
    def validate_dimensions(cls, component_type: ComponentType, length: float) -> bool:
        """
        –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.
        
        Args:
            component_type: –¢–∏–ø –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
            length: –î–ª–∏–Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
            
        Returns:
            True –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, False –µ—Å–ª–∏ –Ω–µ—Ç
        """
        tolerance = 0.001  # 1–º–º –¥–æ–ø—É—Å–∫ –Ω–∞ float-—Ç–æ—á–Ω–æ—Å—Ç—å
        
        if component_type == ComponentType.LEDGER:
            return any(abs(length - std) < tolerance for std in cls.LEDGER_LENGTHS)
        elif component_type == ComponentType.STANDARD:
            return any(abs(length - std) < tolerance for std in cls.STANDARD_HEIGHTS)
        elif component_type == ComponentType.DIAGONAL:
            return any(abs(length - std) < tolerance for std in cls.DIAGONAL_LENGTHS)
        
        return True  # –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–∫–∞ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ–º
    
    @classmethod
    def get_component_library(cls) -> Dict[str, LayherComponent]:
        """
        –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Layher.
        
        Returns:
            –°–ª–æ–≤–∞—Ä—å {–∫–æ–¥: LayherComponent}
        """
        library = {}
        
        # ‚ïê‚ïê‚ïê –†–ò–ì–ï–õ–ò (Ledgers) ‚ïê‚ïê‚ïê
        for length in cls.LEDGER_LENGTHS:
            code = f"L-{int(length*100)}"
            library[code] = LayherComponent(
                type=ComponentType.LEDGER,
                length=length,
                weight=5.0 + length * 2.5,  # –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –≤–µ—Å–∞
                max_load=cls.MAX_LEDGER_LOAD.get(length, 2.0),
                code=code
            )
        
        # ‚ïê‚ïê‚ïê –°–¢–û–ô–ö–ò (Standards) ‚ïê‚ïê‚ïê
        for height in cls.STANDARD_HEIGHTS:
            code = f"S-{int(height*100)}"
            library[code] = LayherComponent(
                type=ComponentType.STANDARD,
                length=height,
                weight=8.0 + height * 3.5,
                max_load=cls.MAX_STANDARD_LOAD,
                code=code
            )
        
        # ‚ïê‚ïê‚ïê –î–ò–ê–ì–û–ù–ê–õ–ò (Diagonals) ‚ïê‚ïê‚ïê
        for length in cls.DIAGONAL_LENGTHS:
            code = f"D-{int(length*100)}"
            library[code] = LayherComponent(
                type=ComponentType.DIAGONAL,
                length=length,
                weight=4.0 + length * 1.8,
                max_load=cls.MAX_DIAGONAL_TENSION,
                code=code
            )
        
        return library
    
    @classmethod
    def calculate_required_diagonals(cls, width: float, height: float, 
                                     load_ratio: float) -> int:
        """
        –†–∞—Å—á–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–≥—Ä—É–∑–∫–∏.
        
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Closed Loop –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∞–≤—Ç–æ-—É—Å–∏–ª–µ–Ω–∏—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
        
        Args:
            width: –®–∏—Ä–∏–Ω–∞ —Å–µ–∫—Ü–∏–∏ –≤ –º–µ—Ç—Ä–∞—Ö
            height: –í—ã—Å–æ—Ç–∞ —Å–µ–∫—Ü–∏–∏ –≤ –º–µ—Ç—Ä–∞—Ö
            load_ratio: –¢–µ–∫—É—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ / –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (0.0 - 1.0)
            
        Returns:
            –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∏–∞–≥–æ–Ω–∞–ª–µ–π –¥–ª—è —ç—Ç–æ–π —Å–µ–∫—Ü–∏–∏
        """
        base_diagonals = 1  # –ú–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å –Ω–∞ —Å–µ–∫—Ü–∏—é
        
        # –ï—Å–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∞ –≤ –∂–µ–ª—Ç–æ–π –∑–æ–Ω–µ (>70%) ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –¥–∏–∞–≥–æ–Ω–∞–ª–∏
        if load_ratio > cls.WARNING_LOAD_THRESHOLD:
            base_diagonals = 2
        
        # –ï—Å–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∞ –≤ –∫—Ä–∞—Å–Ω–æ–π –∑–æ–Ω–µ (>90%) ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ
        if load_ratio > cls.CRITICAL_LOAD_THRESHOLD:
            base_diagonals = 3
        
        # –£—á–∏—Ç—ã–≤–∞–µ–º –ø–ª–æ—â–∞–¥—å —Å–µ–∫—Ü–∏–∏ (–±–æ–ª—å—à–∏–µ —Å–µ–∫—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –¥–∏–∞–≥–æ–Ω–∞–ª–µ–π)
        area = width * height
        if area > 6.0:  # –°–µ–∫—Ü–∏—è –±–æ–ª—å—à–µ 6 –º¬≤
            base_diagonals += 1
        if area > 9.0:  # –°–µ–∫—Ü–∏—è –±–æ–ª—å—à–µ 9 –º¬≤
            base_diagonals += 1
        
        return min(base_diagonals, 4)  # –ú–∞–∫—Å–∏–º—É–º 4 –¥–∏–∞–≥–æ–Ω–∞–ª–∏ –Ω–∞ —Å–µ–∫—Ü–∏—é


class RosetteConnection:
    """
    –ú–æ–¥–µ–ª—å —Ä–æ–∑–µ—Ç–∫–∏ (—É–∑–ª–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è).
    
    –†–æ–∑–µ—Ç–∫–∞ ‚Äî —ç—Ç–æ —É–∑–µ–ª –Ω–∞ —Å—Ç–æ–π–∫–µ, –≤ –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –¥–æ 8 —Ä–∏–≥–µ–ª–µ–π.
    –†–æ–∑–µ—Ç–∫–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–µ 0.5–º –ø–æ –≤—ã—Å–æ—Ç–µ —Å—Ç–æ–π–∫–∏.
    """
    
    def __init__(self, position: Tuple[float, float, float], standard_id: str):
        """
        Args:
            position: (x, y, z) –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ä–æ–∑–µ—Ç–∫–∏ –≤ –º–µ—Ç—Ä–∞—Ö
            standard_id: ID —Å—Ç–æ–π–∫–∏, –∫ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ä–æ–∑–µ—Ç–∫–∞
        """
        self.position = position
        self.standard_id = standard_id
        self.connections: List[str] = []  # –°–ø–∏—Å–æ–∫ ID –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Ä–∏–≥–µ–ª–µ–π
        
    def can_add_connection(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"""
        return len(self.connections) < LayherStandards.ROSETTE_MAX_CONNECTIONS
    
    def add_connection(self, component_id: str) -> bool:
        """
        –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ä–æ–∑–µ—Ç–∫–µ.
        
        Args:
            component_id: ID —Ä–∏–≥–µ–ª—è –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
            
        Returns:
            True –µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ, False –µ—Å–ª–∏ —Ä–æ–∑–µ—Ç–∫–∞ –ø–æ–ª–Ω–∞—è
        """
        if self.can_add_connection():
            self.connections.append(component_id)
            return True
        return False
    
    def get_load_factor(self) -> float:
        """
        –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–æ–∑–µ—Ç–∫–∏ (0.0 - 1.0).
        
        Returns:
            –û—Ç–Ω–æ—à–µ–Ω–∏–µ –∑–∞–Ω—è—Ç—ã—Ö —Å–ª–æ—Ç–æ–≤ –∫ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
        """
        return len(self.connections) / LayherStandards.ROSETTE_MAX_CONNECTIONS
    
    def is_overloaded(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Ä–æ–∑–µ—Ç–∫–∏"""
        return len(self.connections) > LayherStandards.ROSETTE_MAX_CONNECTIONS


class BillOfMaterials:
    """
    Bill of Materials (BOM) - —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.
    
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –º–æ–∂–Ω–æ —Ä–µ–∞–ª—å–Ω–æ —Å–æ–±—Ä–∞—Ç—å –ª–µ—Å–∞
    –Ω–∞ —Å–∫–ª–∞–¥–µ Layher.
    """
    
    def __init__(self):
        self.components: Dict[str, int] = {}  # {–∫–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ}
        self.library = LayherStandards.get_component_library()
        
    def add_component(self, code: str, quantity: int = 1):
        """
        –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é.
        
        Args:
            code: –ö–æ–¥ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä "L-207" –¥–ª—è —Ä–∏–≥–µ–ª—è 2.07–º)
            quantity: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à—Ç—É–∫
        """
        if code in self.components:
            self.components[code] += quantity
        else:
            self.components[code] = quantity
    
    def get_total_weight(self) -> float:
        """
        –†–∞—Å—á–µ—Ç –æ–±—â–µ–≥–æ –≤–µ—Å–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
        
        Returns:
            –í–µ—Å –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö
        """
        total = 0.0
        for code, qty in self.components.items():
            if code in self.library:
                total += self.library[code].weight * qty
        return total
    
    def get_total_cost(self, price_per_kg: float = 15.0) -> float:
        """
        –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.
        
        Args:
            price_per_kg: –¶–µ–Ω–∞ –∑–∞ –∫–∏–ª–æ–≥—Ä–∞–º–º —Å—Ç–∞–ª–∏ (USD)
            
        Returns:
            –°—Ç–æ–∏–º–æ—Å—Ç—å –≤ USD
        """
        return self.get_total_weight() * price_per_kg
    
    def validate_inventory(self, available_inventory: Dict[str, int]) -> Dict[str, int]:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ.
        
        Args:
            available_inventory: –°–ª–æ–≤–∞—Ä—å {–∫–æ–¥: –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ}
            
        Returns:
            –°–ª–æ–≤–∞—Ä—å {–∫–æ–¥: –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ} (–ø—É—Å—Ç–æ–π –µ—Å–ª–∏ –≤—Å–µ –µ—Å—Ç—å)
        """
        missing = {}
        for code, required_qty in self.components.items():
            available_qty = available_inventory.get(code, 0)
            if available_qty < required_qty:
                missing[code] = required_qty - available_qty
        return missing
    
    def export_csv(self) -> str:
        """
        –≠–∫—Å–ø–æ—Ä—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ CSV —Ñ–æ—Ä–º–∞—Ç.
        
        Returns:
            CSV —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
        """
        lines = ["–ö–æ–¥,–¢–∏–ø,–î–ª–∏–Ω–∞_–º,–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ,–í–µ—Å_–∫–≥,–ú–∞–∫—Å_–ù–∞–≥—Ä—É–∑–∫–∞_–∫–ù"]
        
        for code, qty in sorted(self.components.items()):
            if code in self.library:
                comp = self.library[code]
                lines.append(
                    f"{code},{comp.type.value},{comp.length:.2f},"
                    f"{qty},{comp.weight:.1f},{comp.max_load:.1f}"
                )
            else:
                lines.append(f"{code},unknown,?,{qty},?,?")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç—Ä–æ–∫—É
        total_weight = self.get_total_weight()
        total_items = sum(self.components.values())
        lines.append(f"–ò–¢–û–ì–û,,,{total_items},{total_weight:.1f},")
        
        return "\n".join(lines)
    
    def __repr__(self):
        total_items = sum(self.components.values())
        total_weight = self.get_total_weight()
        return (f"BOM: {len(self.components)} —Ç–∏–ø–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, "
                f"{total_items} —à—Ç—É–∫, {total_weight:.1f} –∫–≥")


# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def snap_to_layher_grid(value: float, grid_type: str = "ledger") -> float:
    """
    –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∫ –±–ª–∏–∂–∞–π—à–µ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É Layher.
    
    Args:
        value: –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤ –º–µ—Ç—Ä–∞—Ö
        grid_type: "ledger", "standard", –∏–ª–∏ "diagonal"
        
    Returns:
        –ë–ª–∏–∂–∞–π—à–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä
    """
    if grid_type == "ledger":
        return LayherStandards.get_nearest_ledger_length(value)
    elif grid_type == "standard":
        return LayherStandards.get_nearest_standard_height(value)
    elif grid_type == "diagonal":
        nearest = min(LayherStandards.DIAGONAL_LENGTHS, 
                     key=lambda x: abs(x - value))
        return nearest
    else:
        return value


def validate_scaffold_dimensions(nodes: List[Dict], beams: List[Dict]) -> List[str]:
    """
    –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≤—Å–µ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Layher.
    
    Args:
        nodes: –°–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ [{id, x, y, z}, ...]
        beams: –°–ø–∏—Å–æ–∫ –±–∞–ª–æ–∫ [{id, start, end, type}, ...]
        
    Returns:
        –°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ (–ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ –µ—Å–ª–∏ –≤—Å–µ –û–ö)
    """
    errors = []
    node_map = {n['id']: n for n in nodes}
    
    for beam in beams:
        # –í—ã—á–∏—Å–ª—è–µ–º –¥–ª–∏–Ω—É –±–∞–ª–∫–∏
        start_node = node_map.get(beam['start'])
        end_node = node_map.get(beam['end'])
        
        if not start_node or not end_node:
            errors.append(f"–ë–∞–ª–∫–∞ {beam['id']}: —É–∑–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
            continue
        
        dx = end_node['x'] - start_node['x']
        dy = end_node['y'] - start_node['y']
        dz = end_node['z'] - start_node['z']
        length = math.sqrt(dx**2 + dy**2 + dz**2)
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –±–∞–ª–∫–∏ –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ–º
        beam_type = beam.get('type', 'ledger')
        
        if beam_type == 'ledger' or beam_type == 'transom':
            if not LayherStandards.validate_dimensions(ComponentType.LEDGER, length):
                nearest = LayherStandards.get_nearest_ledger_length(length)
                errors.append(
                    f"–ë–∞–ª–∫–∞ {beam['id']}: –¥–ª–∏–Ω–∞ {length:.3f}–º –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è. "
                    f"–ë–ª–∏–∂–∞–π—à–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç: {nearest:.2f}–º"
                )
        
        elif beam_type == 'standard':
            if not LayherStandards.validate_dimensions(ComponentType.STANDARD, length):
                nearest = LayherStandards.get_nearest_standard_height(length)
                errors.append(
                    f"–°—Ç–æ–π–∫–∞ {beam['id']}: –≤—ã—Å–æ—Ç–∞ {length:.3f}–º –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è. "
                    f"–ë–ª–∏–∂–∞–π—à–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç: {nearest:.2f}–º"
                )
    
    return errors


# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –¢–ï–°–¢–´ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

if __name__ == "__main__":
    print("üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï LAYHER STANDARDS")
    print("=" * 70)
    
    # –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
    print("\n1. –¢–µ—Å—Ç –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º:")
    test_values = [1.0, 1.23, 2.0, 2.13, 3.0, 3.5]
    for val in test_values:
        nearest = LayherStandards.get_nearest_ledger_length(val)
        print(f"   {val}–º ‚Üí {nearest}–º")
    
    # –¢–µ—Å—Ç 2: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    print("\n2. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:")
    library = LayherStandards.get_component_library()
    print(f"   –í—Å–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ: {len(library)}")
    print(f"   –†–∏–≥–µ–ª–∏: {len([c for c in library.values() if c.type == ComponentType.LEDGER])}")
    print(f"   –°—Ç–æ–π–∫–∏: {len([c for c in library.values() if c.type == ComponentType.STANDARD])}")
    
    # –¢–µ—Å—Ç 3: BOM
    print("\n3. –¢–µ—Å—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ (BOM):")
    bom = BillOfMaterials()
    bom.add_component("L-207", 10)  # 10 —Ä–∏–≥–µ–ª–µ–π 2.07–º
    bom.add_component("S-200", 4)   # 4 —Å—Ç–æ–π–∫–∏ 2.0–º
    bom.add_component("D-200", 8)   # 8 –¥–∏–∞–≥–æ–Ω–∞–ª–µ–π 2.0–º
    print(f"   {bom}")
    print(f"   –û–±—â–∏–π –≤–µ—Å: {bom.get_total_weight():.1f} –∫–≥")
    print(f"   –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${bom.get_total_cost():.2f}")
    
    # –¢–µ—Å—Ç 4: –í–∞–ª–∏–¥–∞—Ü–∏—è
    print("\n4. –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–æ–≤:")
    is_valid_207 = LayherStandards.validate_dimensions(ComponentType.LEDGER, 2.07)
    is_valid_200 = LayherStandards.validate_dimensions(ComponentType.LEDGER, 2.00)
    print(f"   2.07–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç): {'‚úì –í–ê–õ–ò–î–ù–û' if is_valid_207 else '‚úó –ë–†–ê–ö'}")
    print(f"   2.00–º (–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç): {'‚úì –í–ê–õ–ò–î–ù–û' if is_valid_200 else '‚úó –ë–†–ê–ö'}")
    
    print("\n" + "=" * 70)
    print("‚úì –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã!")